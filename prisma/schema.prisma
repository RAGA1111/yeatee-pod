generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id        String    @id @default(uuid())
  name      String
  email     String    @unique
  password  String    // Hashed password
  designs   Design[]
  products  Product[] // Products created by this user
  orders    Order[]   // Orders placed by this user
}

model Design {
  id        String    @id @default(uuid())
  imageUrl  String
  userId    String
  user      User      @relation(fields: [userId], references: [id])
  products  Product[]
}

model Product {
  id          String   @id @default(uuid())
  title       String
  designId    String
  design      Design   @relation(fields: [designId], references: [id])
  creatorId   String
  creator     User     @relation(fields: [creatorId], references: [id])
  size        String   // Fixed size for this product variant
  color       String   // Fixed color for this product variant
  price       Float    // Selling price
  orders      Order[]
}

model Vendor {
  id        String   @id @default(uuid())
  name      String
  baseCost  Float    // Cost of the blank shirt
  printCost Float    // Cost to print
  orders    Order[]
}

model Order {
  id          String   @id @default(uuid())
  userId      String   // Customer
  user        User     @relation(fields: [userId], references: [id])
  productId   String
  product     Product  @relation(fields: [productId], references: [id])
  vendorId    String?  // Assigned automatically
  vendor      Vendor?  @relation(fields: [vendorId], references: [id])
  quantity    Int      @default(1)
  
  // Financials - Saved explicitly for transparency
  baseCost    Float?   // Vendor base cost at time of order
  printCost   Float?   // Vendor print cost at time of order
  platformFee Float?   // My margin
  totalCost   Float    // Total cost to fulfill
  finalPrice  Float    // Price user paid

  status      String   @default("PENDING")
  createdAt   DateTime @default(now())
}
